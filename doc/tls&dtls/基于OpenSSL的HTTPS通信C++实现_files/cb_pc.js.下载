/*! 2022 Baidu Inc. All Rights Reserved */
!function(e){var t=location.host,i=encodeURIComponent(location.href),n=~t.indexOf("jpaas")?"//"+t:"https://cpu.baidu.com",o=[],s="pc";if(Array.prototype.some=Array.prototype.some||function(e){for(var t=0;t<this.length;t++)if(e.call(this,this[t],t))return!0;return!1},Array.prototype.filter=Array.prototype.filter||function(e){for(var t=[],i=0;i<this.length;i++)if(e.call(this,this[i],i))t.push(this[i]);return t},Array.prototype.forEach=Array.prototype.forEach||function(e){for(var t=0;t<this.length;t++)e.apply(this,[this[t],t,this])},!Object.keys)Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,i=[];for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))i.push(t);return i};var a=function(){var e=document.title,t=document.getElementsByName("keywords")[0]&&document.getElementsByName("keywords")[0].getAttribute("content")||"",i=["title="+encodeURIComponent(e),"keywords="+encodeURIComponent(t)];return i.join("&")},r=function(e){if(!e||"[object Object]"!==Object.prototype.toString.call(e))return"";var t=["siteId","blockId","display"],i=[];return Object.keys(e).filter(function(e){return!~t.indexOf(e)}).forEach(function(t){i.push(t+"="+encodeURIComponent(e[t]))}),i.join("&")},l=function(){if(!(e.dataBackToFeed instanceof Array&&e.dataBackToFeed.length))return"";var t=e.dataBackToFeed[0];if(!t.outerId)return"";var i=Object.keys(t),n=[],o="outerId="+encodeURIComponent(t.outerId)+"&";if(i.forEach(function(e){if("outerId"!==e&&"number"==typeof t[e])n.push(e+"="+encodeURIComponent(t[e]))}),!n.length)return"";else return o+=n.join("&")},d={init:function(){var t=this,i=function(){t.throttleTrack()};if(t.checkScroll())if(e.addEventListener)e.addEventListener("scroll",i);else if(e.attachEvent)e.attachEvent("onscroll",i);setInterval(function(){t.trackHandler()},500)},checkScroll:function(){var t;if(t=document.createEvent&&document.createEvent("Events")){try{t.initEvent("scroll",!0,!1)}catch(i){t.initEvent("scroll")}return e.dispatchEvent(t)}},throttleTrack:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.trackHandler()},200)},getDomainFromElement:function(e){var t=e.getElementsByTagName("iframe")[0].getAttribute("src");t=t.replace(/(https?:)?\/\//,"");var i=t.split("/")[0];return i},updateElement:function(e){var t=function i(e,t){if(t=t||e.offsetTop,e&&e.offsetParent&&e.offsetParent!=document.body&&e.offsetParent!=document.documentElement)return t+=e.offsetParent.offsetTop,i(e.offsetParent,t);else return t};e.top=t(e.element),e.left=e.element.offsetLeft,e.height=e.element.clientHeight,e.domain=e.domain||this.getDomainFromElement(e.element),e.blockId=e.blockId||e.element.getAttribute("data-block-id")},getScrollSum:function(t){var i=function n(t,i){if(t==document.body)return i+(e.pageYOffset||document.documentElement.scrollTop||0);else return i+=t.scrollTop,n(t.parentNode,i)};return i(t,0)},compareElement:function(e){var t=this.getScrollSum(e.element);if(e.height>0&&e.top+e.height>t&&e.top<t+this.visible.windowHeight){var i={action:e.action,blockId:e.blockId,height:e.height,top:e.top-t,bottom:t+this.visible.windowHeight-(e.top+e.height)};if(e.cache&&e.cache.top==i.top&&e.cache.height==i.height&&e.cache.bottom==i.bottom)return!1;else return e.cache=i,i}else return!1},updateVisible:function(){this.visible.windowHeight=e.innerHeight||document.documentElement.clientHeight,this.visible.height=document.body.clientHeight},trackElement:function(e){this.updateElement(e);var t=this.compareElement(e);if(t)e.iframe.contentWindow.postMessage(JSON.stringify(t),"*")},trackHandler:function(){var e=this;this.updateVisible();var t=void 0!=this.visible.windowHeight&&void 0!=this.visible.height;if(!t)return!1;else return void this.elements.forEach(function(t){e.trackElement(t)})},push:function(e){var t=this.elements.some(function(t){return t.element==e});if(t)return!1;else return this.elements.push({element:e,iframe:e.getElementsByTagName("iframe")[0],action:"exposure"})},elements:[],visible:{}},c={initFeedsbycpu:function(){var t=this;e.feedsbycpu.push=function(){var e=Array.prototype.slice.call(arguments);return o.push(e),t.getIframes(e),Array.prototype.push.apply(this,e)}},initConfig:function(){e.feedsbycpu=e.feedsbycpu||[],o=e.feedsbycpu.slice()},getContainer:function(e){for(var t=document.getElementsByClassName("cpu-feeds-block"),i=0;i<t.length;i++){var n=t[i];if(n.getAttribute("data-site-id")==e.siteId&&n.getAttribute("data-block-id")==e.blockId)return n}},createIframe:function(e,t){if(!(e.siteId&&e.blockId&&t))return!1;var o=t.getAttribute("data-feeds-loaded");if(o)return!1;var d=[n,"/block/",s,"/",e.siteId,"/",e.blockId,"?source=",i,"&",a(),"&",r(e)].join(""),c=l();if(c)d=d+"&"+c;var p=document.createElement("iframe");p.src=d,p.frameBorder=0,p.height=0,t.setAttribute("data-feeds-loaded",1),t.appendChild(p)},createCloseBtn:function(e){var t="/img/close_2x.png",i="/img/close_1x.png",o=document.createElement("i");o.setAttribute("class","block-close-btn"),this.extend(o.style,{backgroundImage:"url('"+n+(this.ie8()?i:t)+"')",position:"absolute",top:"10px",right:"16px",width:"15px",height:"15px",display:"inline-block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"top right",cursor:"pointer"}),e.appendChild(o),o.onclick=this.close.bind(this)},autoClose:function(){e.setTimeout(this.close.bind(this),1e4)},close:function(e){this.container.style.display="none"},ie8:function(){var e,t="8.0",i=navigator.userAgent.toLowerCase(),n=i.indexOf("msie")>-1;if(n)e=i.match(/msie ([\d.]+)/)[1];if(t>=e)return!0;else return!1},getIframes:function(e){for(var t=this,i=0;i<e.length;i++){var n=e[i],o=this.container=t.getContainer(n);if(!o)return!1;t.createIframe(n,o)}},getElementsByClassName:function(){if(!document.getElementsByClassName)document.getElementsByClassName=function(e,t){for(var i=(t||document).getElementsByTagName("*"),n=new Array,o=0;o<i.length;o++)for(var s=i[o],a=s.className.split(" "),r=0;r<a.length;r++)if(a[r]==e){n.push(s);break}return n};return document.getElementsByClassName},bind:function(){if(!Function.prototype.bind)Function.prototype.bind=function(e,t){var i=this;return function(){i.apply(e,t)}}},setHeight:function(e,t){var i=e.getElementsByTagName("iframe")[0];if(106!=t.blockStyleType){if(115==t.blockStyleType)t.w="100%";if(e.style.height=t.h+"px",e.style.width="100%"===t.w?t.w:t.w+"px",i.width=t.w,i.height=t.h,"true"!=t.iframeScroll)i.scrolling="no";this.trackElement(e),d.trackHandler()}},trackElement:function(e){var t=e.getAttribute("data-feeds-tracked");if(!t)d.push(e),e.setAttribute("data-feeds-tracked",1)},parse:function(e){for(var t={},i=e.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");t[o[0]]=o[1]}return t},initMsgListener:function(){function t(e){var t=e.origin||e.originalEvent.origin;if(!/^https?\:\/\/.+\.baidu\.com/.test(t))return!1;var n=e.data;if("string"==typeof n)n=i.parse(n);n.h=n.h||0;var o=i.getContainer(n);if(!o)return!1;if("resize"===n.action)i.setHeight(o,n);if("close"===n.action)i.removeBlock(o)}var i=this;if(e.addEventListener)e.addEventListener("message",t,!0);else if(e.attachEvent)e.attachEvent("onmessage",t)},init:function(){this.bind(),this.getElementsByClassName(),this.initConfig(),this.getIframes(o),this.initFeedsbycpu(),this.initMsgListener()},extend:function(e,t){if(e&&t)for(var i in t)e[i]=t[i];return e}};c.init(),d.init()}(window);