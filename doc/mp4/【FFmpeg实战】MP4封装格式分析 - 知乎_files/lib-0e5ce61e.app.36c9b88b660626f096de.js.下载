"use strict";(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[887],{64099:function(e,t,o){o.d(t,{As:function(){return td},BU:function(){return tZ},EN:function(){return ti},Ho:function(){return tW},RK:function(){return tz},RP:function(){return tB},S_:function(){return tr},TS:function(){return eH},Zd:function(){return tD},cx:function(){return ej},fN:function(){return eV},p1:function(){return eU},pE:function(){return tI},rI:function(){return tC}});var n=o(9338),r=o(22107),a=o(94707),i=o(87320),c=o(55164),l=o(57477),s=o(71728),u=o(94009),d=o(79065),f=o(49899),h=o(30971),m=o(85879),g=o(87363),p=o(88329),v=o.n(p),A=o(69383);o(75570);var k=o(51991),b=o(65733),C=o(75798),y=o(91850),w=o(17103),x=o(83537),L=o(14168),B=o.n(L),z=o(67814),_=o.n(z),S=o(41402),G=o(37831),Z=o(92769),R=o.n(Z),I=o(88423),E=o(74135),T=o(76073),N=o.n(T),P=o(7629),W=o(78842),D=o(30722),M=o(11612),K=o.n(M),V=o(41550),q=o(23579),U=o(80565),j=o(74351),O=o(18837),H=o.n(O),X=o(20072),F=o(61533),Q=o(4667),Y=o.n(Q),J=o(32193),$=o(54231),ee=o(57045),et=o(51940);function eo(){var e=(0,d._)(["\n   from { opacity: 0; }\n   to { opacity: 1; }\n"]);return eo=function(){return e},e}var en=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return function(e){t.forEach(function(t){"function"==typeof t?t(e):t&&(t.current=e)})}};function er(e){var t=this;return e.length?function(o,n){for(var r=e.length-1,a=o;r>=0;)a=e[r].call(t,a,n),r--;return a}:v()}var ea=function(e){var t=function(e){if(0!==e.intersectionRatio){var t=e.target;t.dataset.zaDetailViewId=t.cardShowViewId,A.Z.trackCardShow(t,{},{link:{url:t.href}}),o.unobserve(t),t.clickViewId&&(t.dataset.zaDetailViewId=t.clickViewId)}},o=new IntersectionObserver(function(e){e.forEach(t)},{threshold:[.1]});return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'},{cardShowViewId:7692,selector:"a.FileLinkCard .FileLinkCard-info"},{cardShowViewId:9744,selector:".Catalog"}].forEach(function(t){var n=t.selector,r=t.cardShowViewId,a=t.clickViewId;Array.from(e.querySelectorAll(n)).forEach(function(e){e.cardShowViewId=r,e.clickViewId=a,o.observe(e)})}),function(){o.disconnect()}},ei="function"==typeof queueMicrotask?queueMicrotask:function(e){return Promise.resolve().then(e)},ec=function(e){var t=(0,g.useRef)(null);(0,g.useEffect)(function(){if(e)return ei(function(){e&&(t.current=ea(e))}),function(){t.current&&t.current()}},[e])},el=function(e){return{elementLocation:{type:"Button",content:{type:e.dataset.zaContentType}}}},es=function(e){return{attachedInfoBytes:e.dataset.zaAttachInfo}},eu=[{selector:"a.external, a.internal",zaBlock:"ZTextLink"},{selector:"a.member_mention, a.UserLink-link",zaBlock:"ZTextMention"},{selector:"a.video-box",zaBlock:"ZTextVideoCard"},{selector:'a.LinkCard.old[data-draft-type="link-card"]',zaBlock:"ZTextLinkCard"},{selector:'a.LinkCard.new.static[data-draft-type="link-card"]:not([data-za-content-type="Zvideo"])',zaBlock:"ZTextLinkCard",viewInfoBuilder:el,extraInfoBuilder:es},{selector:'a.LinkCard.new.static[data-draft-type="link-card"][data-za-content-type="Zvideo"]',zaBlock:"ZTextZVideoLinkCard",viewInfoBuilder:el,extraInfoBuilder:es},{selector:"a.FileLinkCard",zaBlock:"ZTextFileLinkCard"}],ed=function(e){var t,o,n=e.element,r=e.config,a=null===(t=r.viewInfoBuilder)||void 0===t?void 0:t.call(r,n,r),i=(0,c._)({elementLocation:{type:"Button"},block:r.zaBlock},a),l=(0,c._)({action:"OpenUrl",elementLocation:{type:"Button"},block:r.zaBlock,eventType:"Click"},a),s=(0,c._)({link:{url:n.href}},null===(o=r.extraInfoBuilder)||void 0===o?void 0:o.call(r,n,r)),u=(0,k.Q4)().trackEvent,d=(0,k.x3)(i,s),f=(0,b.A)(function(e){u(l,s),"ZTextLinkCard"===r.zaBlock&&n.dataset.isEcommerce&&e.preventDefault()});return(0,g.useEffect)(function(){return n.addEventListener("click",f),function(){n.removeEventListener("click",f)}},[]),(0,g.useEffect)(function(){return d(n),function(){return d(null)}},[]),null},ef=function(e){var t=e.root,o=(0,u._)((0,g.useState)([]),2),n=o[0],r=o[1];return(0,g.useEffect)(function(){if(t){var e=[];eu.forEach(function(o){var n=o.selector;Array.from(t.querySelectorAll(n)).forEach(function(t){e.push({el:t,config:o})})}),r(e)}},[t]),(0,m.tZ)(g.Fragment,{children:n.map(function(e,t){var o=e.el,n=e.config;return(0,m.tZ)(ed,{element:o,config:n},t)})})},eh=/<p><br><\/p>/g,em=/<[^<>\s]+(\s|>)/,eg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBK05A)}},ep=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBL07A)}},ev=function(e){return{color:e.colors.GBL07A,"&:hover":ep(e)}},eA=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[data-focus-visible]";return(0,i._)({outline:"none",transition:"box-shadow 0.3s"},"html".concat(t," &"),{boxShadow:"0 0 0 2px ".concat(e.colors.GBK99A,", 0 0 0 4px ").concat(e.colorMod(e.colors.GBL01A).alpha(.3))})},ek=(0,S.F4)(eo()),eb="#fff",eC=function(e){var t="1.4em";return(0,c._)({wordBreak:"break-word",lineHeight:"1.6","> [data-first-child]":{marginTop:0},"> :last-child":{marginBottom:0},"h1,h2":{clear:"left",marginTop:"calc((".concat(t," * 2) / 1.2)"),marginBottom:"calc(".concat(t," / 1.2)"),fontSize:"1.2em",lineHeight:1.5,fontWeight:e.fontWeights.bold},"h3,h4,h5,h6":{clear:"left",marginTop:"calc((".concat(t," * 1.5) / 1.1)"),marginBottom:"calc(".concat(t," / 1.1)"),fontSize:"1.1em",lineHeight:"1.5",fontWeight:e.fontWeights.bold},u:{textDecoration:"none",borderBottom:"1px solid ".concat(e.colors.GBK03A)},b:{fontWeight:e.fontWeights.bold},sup:{fontSize:"0.8em"},"sup[data-draft-type='reference']":{color:e.colors.GBL07A},"a:focus":eA(e),"a.ztext-link,a.internal,a.external":(0,l._)((0,c._)({textDecoration:"none",cursor:"pointer"},eg(e)),{"&:hover":(0,c._)({color:e.colors.GBL07A},ep(e))," > .ellipsis::after":{content:"'...'"},"> .invisible":{font:"0/0 a",color:"transparent",textShadow:"none",backgroundColor:"transparent"},u:{border:"none"}}),"a.member_mention":ev(e),"a.UserLink-link":ev(e),p:{margin:"".concat(t," 0")},"p.ztext-empty-paragraph":{margin:"calc((".concat("2.8em","- (").concat(t," * 2 + 1.6em)) / 2) 0"),"+ .ztext-empty-paragraph":{margin:"".concat(t," 0")}},hr:{margin:"4em auto",width:"240px",maxWidth:"100%",border:"none",borderTop:"1px solid ".concat(e.colors.GBK08A)},"img[eeimg]":(0,c._)({maxWidth:"100%",verticalAlign:"middle"},e.isDarkMod&&{filter:"invert(1)"}),'img[eeimg="1"]':{margin:"0 3px",maxWidth:"calc(100% - 6px)",display:"inline-block"},'img[eeimg="2"]':{margin:"".concat(t," auto"),display:"block"},blockquote:{margin:"".concat(t," 0"),paddingLeft:"1em",color:e.colors.GBK04A,borderLeft:"3px solid ".concat(e.colors.GBK08A)},"ol,ul":{margin:"".concat(t," 0"),padding:0,width:"100%","ol,ul":{margin:0},"li::before":{width:"1em"},"> ol, > ul":{paddingLeft:"1em",boxSizing:"border-box"}},ul:{"&>li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",content:"'•  '",whiteSpace:"pre"}}},ol:{counterReset:"ol","> li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",textAlign:"right",counterIncrement:"ol",content:"counter(ol) '. '",whiteSpace:"pre"}}},"ol ol":{counterReset:"ol2","li::before":{counterIncrement:"ol2",content:"counter(ol2) '. '"}},"ol ol ol":{counterReset:"ol3","li::before":{counterIncrement:"ol3",content:"counter(ol3) '. '"}},"ol ol ol ol":{counterReset:"ol4","li::before":{counterIncrement:"ol4",content:"counter(ol4) '. '"}},figure:{margin:"".concat(t," 0"),".content_image,.origin_image":{margin:"0 auto"},figcaption:{marginTop:"calc(0.6em / 0.9)",padding:"0 1em",fontSize:"0.9em",lineHeight:"1.5",textAlign:"center",color:e.colors.GBK06A},"& + figure":{marginTop:"calc(".concat(t," * 1.6)")},"&[data-size='small'],&:not([data-size]) > [data-size='small']":{clear:"both"},"&[data-size='left'],&:not([data-size]) > [data-size='left']":{float:"left",margin:"0 20px 20px 0",maxWidth:"33%"},"&[data-size='right'],&:not([data-size]) > [data-size='right']":{float:"right",margin:"0 0 20px 20px",maxWidth:"33%"},"&[data-size='collapse']":{marginBottom:0,"& + figure":{marginTop:0}}},".content_image, .origin_image":{display:"block",maxWidth:"100%",height:"auto",margin:"".concat(t," auto"),backgroundColor:eb,"&[data-size='small']":{maxWidth:"40%"},"&.zh-lightbox-thumb":{cursor:"zoom-in"}},code:{margin:"0 2px",padding:"3px 4px",borderRadius:"3px",fontFamily:e.fonts.monospace,fontSize:"0.9em",backgroundColor:e.colors.GBK10A},pre:{margin:"".concat(t," 0"),padding:"calc(0.8em / 0.9)",fontSize:"0.9em",wordBreak:"initial",wordWrap:"initial",whiteSpace:"pre",overflow:"auto",WebkitOverflowScrolling:"touch",background:e.colors.GBK10A,borderRadius:"4px",code:{margin:0,padding:0,fontSize:"inherit",borderRadius:0,backgroundColor:"inherit"}},"li pre":{whiteSpace:"pre-wrap"},"table[data-draft-type='table']":{borderCollapse:"collapse",fontSize:"15px",margin:"".concat(t," auto"),maxWidth:"100%",tableLayout:"fixed",textAlign:"left",width:"100%","&[data-size='small']":{minWidth:"260px",width:"40%"},"&[data-row-style='striped'] tr:nth-of-type(2n + 1)":{background:e.colors.GBK10A},"td,th":{border:"1px solid ".concat(e.colors.GBK08A),lineHeight:"24px",height:"24px",padding:"3px 12px"},th:{background:e.colors.GBK09A,color:e.colors.GBK02A,fontWeight:500}},"& .video-box, & .link-box":{position:"relative",display:"flex",justifyContent:"space-between",margin:"".concat(t," 0"),overflow:"auto",whiteSpace:"normal",cursor:"pointer",border:"solid 1px ".concat(e.colors.GBK09A),borderRadius:"4px"}},{".lazy[data-lazy-status]":{backgroundColor:e.colors.GBK10A},'.lazy[data-lazy-status="ok"]':{backgroundColor:eb,animation:"".concat(ek," 0.5s ease-in")}})},ey=[function(e){return e?e.replace(eh,'<p class="ztext-empty-paragraph"><br /></p>'):e},function(e){return e?e.replace(em,function(e,t){return e.replace(t," data-first-child".concat(t))}):e}],ew=(0,g.forwardRef)(function(e,t){var o,n=e.as,r=e.tag,a=e.className,i=e.html,l=e.clearBoth,u=void 0!==l&&l,d=e.richContentKey,f=e.root,h=e.Portal,g=e.useHooks,p=(0,s._)(e,["as","tag","className","html","clearBoth","richContentKey","root","Portal","useHooks"]),v=er(ey);g(f);var A=null!==(o=null!=n?n:r)&&void 0!==o?o:"div";return(0,m.BX)(m.HY,{children:[h&&(0,m.tZ)(h,{root:f}),(0,m.tZ)(A,(0,c._)({ref:t,css:function(e){return(0,c._)({},eC(e),{"& .highlight":{margin:"1em 0",pre:{margin:0},".hll":{backgroundColor:e.colors.GBK12A},".c":{fontStyle:"italic",color:e.colors.GBK06A},".err":{color:e.colors.GRD03A},".k":{fontWeight:e.fontWeights.bold},".o":{fontWeight:e.fontWeights.bold},".cm":{fontStyle:"italic",color:e.colors.GBK06A},".cp":{fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".c1":{fontStyle:"italic",color:e.colors.GBK06A},".cs":{fontStyle:"italic",fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".gd":{color:e.colors.GRD01A},".ge":{fontStyle:"italic"},".gr":{color:e.colors.GRD03A},".gh":{color:e.colors.GBK06A},".gi":{color:"#12b370"},".go":{color:e.colors.GBK05A},".gp":{color:e.colors.GBK04A},".gs":{fontWeight:e.fontWeights.bold},".gu":{color:e.colors.GBK06A},".gt":{color:e.colors.GRD03A},".kc":{fontWeight:e.fontWeights.bold},".kd":{fontWeight:e.fontWeights.bold},".kn":{fontWeight:e.fontWeights.bold},".kp":{fontWeight:e.fontWeights.bold},".kr":{fontWeight:e.fontWeights.bold},".kt":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".m":{color:e.colors.GBL01A},".s":{color:e.colors.GRD03A},".na":{color:e.colors.GBL01A},".nb":{color:e.colors.GBL01A},".nc":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".no":{color:e.colors.GBL01A},".ni":{color:e.colors.GRD07A},".ne":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nf":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nn":{color:e.colors.GBK04A},".nt":{color:e.colors.GBL07A},".nv":{color:e.colors.GBL01A},".ow":{fontWeight:e.fontWeights.bold},".w":{color:e.colors.GBK07A},".mf":{color:e.colors.GBL01A},".mh":{color:e.colors.GBL01A},".mi":{color:e.colors.GBL01A},".mo":{color:e.colors.GBL01A},".sb":{color:e.colors.GRD03A},".sc":{color:e.colors.GRD03A},".sd":{color:e.colors.GRD03A},".s2":{color:e.colors.GRD03A},".se":{color:e.colors.GRD03A},".sh":{color:e.colors.GRD03A},".si":{color:e.colors.GRD03A},".sx":{color:e.colors.GRD03A},".sr":{color:e.colors.GYL02A},".s1":{color:e.colors.GRD03A},".ss":{color:e.colors.GRD03A},".bp":{color:e.colors.GBK06A},".vc":{color:e.colors.GBL01A},".vg":{color:e.colors.GBL01A},".vi":{color:e.colors.GBL01A},".il":{color:e.colors.GBL01A},"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-thumb:horizontal":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.5),borderRadius:"6px","&:hover":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.6)}}}},u&&{"&::before, &::after":{clear:"both",content:'""',display:"block"}})},className:_()("RichText","ztext",a,{"RichText--clearBoth":u}),dangerouslySetInnerHTML:{__html:v(i)}},p),d||i)]})});ew.propTypes={as:B().string,tag:B().string,html:B().string.isRequired,clearBoth:B().bool,ref:B().func,Portal:B().func,useHooks:B().func},ew.defaultProps={useHooks:v()};var ex=(0,g.memo)(ew),eL=function(e,t){if(e>0&&t>0){var o=e/t;if(o>1.2)return"180x120";if(o<=.8)return"120x160"}return"ipico"},eB=(0,g.forwardRef)(function(e,t){var o=R()(e,["entityType","entityData","notCommerce"]),n=o.text,r=o.target,a=o.url,i=o.image,u=o.imageWidth,d=o.imageHeight,f=o.component,h=o.className,g=o.size,p=o.children,v=(0,s._)(o,["text","target","url","image","imageWidth","imageHeight","component","className","size","children"]),A=eL(u,d),k=(0,I.imgUrl)(i,A);return(0,m.tZ)(f,(0,l._)((0,c._)((0,l._)((0,c._)({ref:t,target:r,href:a,"data-draft-node":"block","data-draft-type":"link-card"},k&&{"data-image":k},u&&{"data-image-width":u},d&&{"data-image-height":d},g&&{"data-size":g},n!==a&&n&&{"data-text":n}),{className:_()("LinkCard new",h)}),v),{children:p||(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{className:"LinkCard-contents",children:[(0,m.tZ)("span",{className:"LinkCard-title loading","data-text":!0}),(0,m.tZ)("span",{className:"LinkCard-desc loading"})]}),(0,m.tZ)("span",{className:"LinkCard-image LinkCard-image--default"})]})}))});eB.propTypes={component:B().oneOfType([B().string,B().func]),target:B().string,url:B().string.isRequired,text:B().string,image:B().string,imageWidth:B().oneOfType([B().string,B().number]),imageHeight:B().oneOfType([B().string,B().number])},eB.defaultProps={component:"a",target:"_blank"};var ez={answer:{en:"Answer",zh:"回答"},article:{en:"Article",zh:"文章"},zvideo:{en:"Video",zh:"视频"},question:{en:"Question",zh:"问题"},collection:{en:"Collection",zh:"收藏夹"},roundtable:{en:"Roundtable",zh:"圆桌"},topic:{en:"Topic",zh:"话题"},voteupCount:{en:"Voteup",zh:"赞同"},commentCount:{en:"Comment",zh:"评论"},playCount:{en:"Play",zh:"播放"},followerCount:{en:"Follower",zh:"关注"},answerCount:{en:"Answer",zh:"回答"},visitCount:{en:"Visit",zh:"浏览"},discussionCount:{en:"Discussion",zh:"讨论"}},e_={answer:"回答",article:"文章",zvideo:"视频",question:"问题",collection:"收藏夹",roundtable:"圆桌",topic:"话题"},eS={voteupCount:"赞同",commentCount:"评论",playCount:"播放",followerCount:"关注",answerCount:"回答",visitCount:"浏览",discussionCount:"讨论"},eG={answer:["voteupCount","commentCount"],article:["voteupCount","commentCount"],zvideo:["playCount","voteupCount"],question:["followerCount","answerCount"],collection:["visitCount","followerCount"],topic:["visitCount","discussionCount"],default:["followerCount","visitCount"]},eZ=function(e){var t=e.twoLine,o=e.children;return!!o&&(0,m.tZ)("span",{className:_()("LinkCard-title",{"two-line":t}),children:o})},eR=function(e){var t,o=e.data,n=e.language,r=o.objectType,a=(eG[r]||eG.default).map(function(e){var t,r=o[e];return"".concat((0,D.Zh)(r)).concat(null!==(t=ez[e][n])&&void 0!==t?t:eS[e])}).filter(Boolean).join(" \xb7 ");return(0,m.BX)("span",{className:"LinkCard-desc",children:[a,(0,m.tZ)("span",{className:"LinkCard-tag",children:null!==(t=ez[r][n])&&void 0!==t?t:e_[r]})]})},eI=function(e){var t=e.url,o=(0,g.useMemo)(function(){var e=null,o=N()(t,!0);return"link.zhihu.com"===o.hostname&&(e=o.query.target),(e||t).replace(/^https?:\/\//,"")},[t]);return(0,m.BX)("span",{className:"LinkCard-desc",children:[(0,m.tZ)(P.n,{size:14,center:!0}),o]})},eE=function(e){var t=e.url,o=e.isVideo,n=e.ratio,r=e.onClick;return!!t&&(0,m.BX)("span",{className:"LinkCard-image",style:{height:60*(void 0===n?1:n)},children:[(0,m.tZ)("img",{src:t,onClick:r,alt:o?"点击可播放视频":""}),o&&(0,m.tZ)("span",{className:"LinkCard-image--video",children:(0,m.tZ)(W.D,{size:10,center:!0})})]})},eT=(0,g.forwardRef)(function(e,t){var o=e.url,n=e.data,r=e.onClick,a=e.onClickImage,i=e.language,c=n.title,l=n.thumbnail,s=n.objectType;return(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{ref:t,className:"LinkCard-contents",onClick:r,children:[(0,m.tZ)(eZ,{twoLine:!0,children:c}),s?(0,m.tZ)(eR,{data:n,language:void 0===i?"zh":i}):(0,m.tZ)(eI,{url:o})]}),(0,m.tZ)(eE,{url:l,isVideo:"zvideo"===s,onClick:a})]})}),eN=function(e){var t=e.className,o=e.html;return o?(0,m.tZ)("span",{className:"LinkCard-richText ".concat(t),dangerouslySetInnerHTML:{__html:"<object>".concat(o,"</object>")}}):null},eP=function(e){var t=e.data,o=t.title,n=t.desc,r=t.url,a=t.image,i=t.ratio,c=t.isVideo;return(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{className:"LinkCard-contents",children:[(0,m.tZ)(eZ,{twoLine:!0,children:o},"title"),(0,m.tZ)(eN,{className:"LinkCard-desc",html:n}),!n&&(0,m.tZ)(eI,{url:r},"url")]}),(0,m.tZ)(eE,{url:a,ratio:i,isVideo:c})]})},eW={ANSWER:"Answer",ARTICLE:"Column",ZVIDEO:"Zvideo",QUESTION:"Question",COLLECTION:"Collection",ROUNDTABLE:"Roundtable",SPECIAL:"Special",TOPIC:"Topic"},eD=function(e){var t={};if(e.data){var o=(0,E.camelizeKeys)("string"==typeof e.data?JSON.parse(e.data):e.data),n=o.source,r=o.display,a=void 0===r?{}:r,i=o.zaData,s=a.cardOpenUrl,u=a.title,d=a.content,f=a.desc,h=a.image||{};t={source:void 0===n?{}:n,url:s,title:u,content:d,desc:f,image:h.imageUrl,ratio:h.ratio,isVideo:h.isVideo,zaAttachInfo:(void 0===i?{}:i).attachInfo}}return(0,l._)((0,c._)({},t,e),{title:e.text||t.title,image:t.image||e.image})},eM=(0,g.forwardRef)(function(e,t){var o=(0,g.useMemo)(function(){return eD(e)},[e]),n=o.source,r=o.target,a=o.title,i=o.url,c=o.zaAttachInfo;return(0,m.tZ)(eB,{ref:t,notCommerce:!0,target:r,text:a,url:i,"data-za-attach-info":c,"data-za-content-type":eW[null==n?void 0:n.contentType]||"Unknown",className:"static",children:(0,m.tZ)(eP,{data:o})})}),eK=/([-\w]+)(="([^"]+)"|='([^']+)')?/g,eV=function(e){for(var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.decodeValue,r=void 0!==n&&n,a={};t=eK.exec(e);){var i=t[1],c=t[3]||t[4];a[i]=(r?eU(c):c)||""}return a},eq=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function eU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#13;/g,"\r")}function ej(){return Math.max(window.innerHeight/10,100)}var eO=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var o=document.defaultView.getComputedStyle(t);if([o.overflow,o.overflowY,o.overflowX].some(function(e){return"scroll"===e||"auto"===e}))return t;t=t.parentNode||t.parentElement}return window};function eH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=eO(e),r=e.getBoundingClientRect().top+(n.pageYOffset||n.scrollTop||0)-(o?ej():0)-t;n.scrollTo({top:r,behavior:"smooth"})}var eX=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,eF=function(e){var t=e.target,o=e.url,n=e.component,r=e.className;return(0,m.tZ)(n,{target:t,href:o,"data-draft-node":"block","data-draft-type":"link-card","data-is-ecommerce":"1",className:_()("LinkCard",r),children:(0,m.BX)("span",{className:"LinkCard-content LinkCard-ecommerceLoadingCard",children:[(0,m.tZ)("div",{className:"LinkCard-ecommerceLoadingCardAvatarWrapper",children:(0,m.tZ)("img",{src:"https://pic2.zhimg.com/v2-1b0bbef27f0496a58468f92d94c8a80e_l.png",className:"LinkCard-ecommerceLoadingCardNetwork"})}),(0,m.BX)("div",{className:"LinkCard-ecommerceLoadingCardLoadingbar",children:[(0,m.tZ)("span",{}),(0,m.tZ)("span",{})]})]})})};eF.defaultProps={component:"a",target:"_blank"};var eQ=/<a\b([^>]*BIZ(=|%3D)ECOMMERCE[^>]*)>(.*?)<\/a>/g,eY=function(e){if(!e)return{};try{var t=JSON.parse(e);if(!t||"object"!=typeof t)return{};return(0,E.camelizeKeys)(t)}catch(e){return{}}},eJ=(0,g.forwardRef)(function(e,t){var o=e.color,n=e.className,r=(0,s._)(e,["color","className"]);return(0,m.tZ)("span",(0,c._)({ref:t,className:_()("LinkCard-wrapper",n),style:{background:o&&"string"==typeof o?"linear-gradient(180deg, ".concat((0,q.a)(o).alpha(.12)," 0%, ").concat((0,q.a)(o).alpha(0)," 100%)"):"transparent"}},r))}),e$={column:(0,g.forwardRef)(function(e,t){var o=e.data,n=e.onClick,r=e.onClickImage,a=o.extraInfo,i=(0,g.useMemo)(function(){return eY(a)},[a]);return(0,m.BX)(eJ,{color:i.coverColor,ref:t,children:[(0,m.tZ)(eE,{url:i.coverImage,onClick:r,ratio:1.1}),(0,m.BX)("span",{className:"LinkCard-contents",onClick:n,children:[(0,m.tZ)(eZ,{children:i.title}),!!i.subtitle&&(0,m.tZ)("span",{className:"LinkCard-excerpt",children:i.subtitle}),(0,m.tZ)("span",{className:"LinkCard-desc",children:i.metricsText})]})]})}),"podcast-channel":(0,g.forwardRef)(function(e,t){var o=e.data,n=e.onClick,r=e.onClickImage,a=o.extraInfo,i=(0,g.useMemo)(function(){return eY(a)},[a]);return(0,m.BX)(eJ,{color:i.coverColor,ref:t,children:[(0,m.tZ)(eE,{url:i.coverImage,onClick:r,ratio:1.1}),(0,m.BX)("span",{className:"LinkCard-contents",onClick:n,children:[(0,m.tZ)(eZ,{children:i.title}),!!i.subtitle&&(0,m.tZ)("span",{className:"LinkCard-excerpt",children:i.subtitle}),(0,m.BX)("span",{className:"LinkCard-desc",children:[i.metricsText,(0,m.tZ)("span",{className:"LinkCard-tag",children:"播客栏目"})]})]})]})}),"podcast-episode":(0,g.forwardRef)(function(e,t){var o=e.data,n=e.onClick,r=e.onClickImage,a=o.extraInfo,i=(0,g.useMemo)(function(){return eY(a)},[a]),c=" \xb7 "+(null==i.duration?"--":Math.ceil(i.duration/6e4))+" 分钟";return(0,m.BX)(eJ,{color:i.coverColor,ref:t,className:"PodcastEpisodeLinkCard",children:[(0,m.tZ)(eE,{url:i.coverImage,onClick:r,ratio:1.1}),(0,m.BX)("span",{className:"LinkCard-contents",onClick:n,children:[(0,m.tZ)(eZ,{twoLine:!0,children:i.title}),(0,m.BX)("span",{className:"PodcastEpisodeLinkCard-desc",children:[(0,m.tZ)("span",{className:"LinkCard-desc",children:i.podcastChannelTitle}),(0,m.tZ)("span",{className:"PodcastEpisodeLinkCard-duration",children:c}),(0,m.tZ)("span",{className:"PodcastEpisodeLinkCard-collect",children:(0,m.tZ)(V.ZP,{size:"20px",className:"PodcastEpisodeLinkCard-collect-icon"})})]})]}),(0,m.tZ)("span",{className:"PodcastEpisodeLinkCard-play",children:(0,m.tZ)(W.Z,{size:"20px",className:"PodcastEpisodeLinkCard-play-icon"})})]})})},e0=(0,g.forwardRef)(function(e,t){var o=e$[e.data.objectType]||eT;return(0,m.tZ)(o,(0,l._)((0,c._)({},e),{ref:t}))}),e1=function(){function e(t){var o,n,a=this;(0,r._)(this,e),o="fetch",n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.url||(a.url=e),e!==a.url)throw Error("mismatch url\n".concat(e,"\n").concat(a.url),e,a.url);return new Promise(function(e,o){a.addToQueue({options:t,resolve:e,reject:o})})},o in this?Object.defineProperty(this,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[o]=n,this.instance=null,this.customFetch=t,this.delay=200,this.maxDelay=1e3,this.url="",this.queueMaxLength=10,this.queue=[],this.startTime=Date.now(),this.timeout=null,this.initialized=!1}return(0,a._)(e,[{key:"initConfig",value:function(e){var t=e.delay,o=e.maxDelay,n=e.maxBatchCount;t&&(this.delay=t),o&&(this.maxDelay=o),n&&(this.maxBatchCount=n),this.initialized=!0}},{key:"buildFetchParams",value:function(e){var t=(0,u._)(e,1)[0].options,o=e.reduce(function(e,t){var o,n;return(null===(n=(o=t.options).dataBuilder)||void 0===n?void 0:n.call(o,e,t))||e},{}),n=this.url,r=!t.method||"GET"===t.method.toUpperCase();if(r){var a=N()(n,!0);a.query=(0,c._)({},a.query,o),n=a.toString()}return[n,(0,l._)((0,c._)({},t),{data:r?null:(0,c._)({},t.data,o)})]}},{key:"doFetch",value:function(){var e=this;return(0,n._)(function(){var t,o,n;return(0,h.__generator)(this,function(r){switch(r.label){case 0:if(0===e.queue.length)return[2];t=e.queue,e.queue=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.customFetch.apply(e,(0,f._)(e.buildFetchParams(t)))];case 2:return o=r.sent(),t.forEach(function(e){var t=e.options;(0,e.resolve)(t.resultBuilder?t.resultBuilder(o):o)}),[3,4];case 3:return n=r.sent(),t.forEach(function(e){return e.reject(n)}),[3,4];case 4:return[2]}})})()}},{key:"addToQueue",value:function(e){var t=this;this.initialized||this.initConfig(e.options),clearTimeout(this.timeout),(Date.now()-this.startTime>this.maxDelay||this.queue.length>=this.maxBatchCount)&&(this.startTime=Date.now(),this.doFetch()),this.queue.push(e),setTimeout(function(){t.startTime=Date.now(),t.doFetch()},this.delay)}}]),e}(),e2=null,e4=function(e){var t;return t=(0,n._)(function(t,o){return(0,h.__generator)(this,function(n){switch(n.label){case 0:return[4,e(t,o)];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}})}),function(e,o){return t.apply(this,arguments)}},e3=function(){throw Error("Not implemented")},e6=function(){var e;return e=e4("undefined"!=typeof fetch?fetch:e3),function(t,o){return e2||(e2=new e1(e)),e2.fetch(t,o)}},e7=H()(function(e){var t=e?"/api/v4/content/publish/link_card_infos":"/api/v4/link_card_infos";if(!(0,j.isBrowser)())return"https://www.zhihu.com".concat(t);var o=window.location,n=o.hostname,r=o.origin;return[".zpres.zhihu.dev",".zpres.zhihu.com"].some(function(e){return n.endsWith(e)})?"".concat(r).concat(t):"https://www.zhihu.com".concat(t)}),e8={},e9=function(e){var t=(0,g.useRef)(0),o=e.inEditor,r=e["data-offset-key"],a=e["data-text"],i=e["data-image"],s=e.href,d=e.onFetchSuccess,f=e.enableNewCardStyle,m=(0,g.useRef)(!1),p=(0,g.useRef)(s),v="draftjs"===o,A=(0,u._)((0,g.useState)(function(){return v&&e8[r]||null}),2),k=A[0],y=A[1],w=(0,u._)((0,C.Y)({once:!0}),2),x=w[0],L=w[1],B=(0,b.A)(function(e){var t=e||k;if(!t||0===Object.keys(t).length)return{objectType:null,title:a||s,thumbnail:i};t.title=a||t.title||s,t.thumbnail=i||t.thumbnail;var o=(0,l._)((0,c._)({},t),{cached:!0});return v&&(e8[r]=o),o}),z=(0,b.A)(e6()),_=(0,b.A)((0,n._)(function(){var e;return(0,h.__generator)(this,function(o){switch(o.label){case 0:t.current+=1,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,z(e7(f),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},dataBuilder:function(e){return e.urls="".concat(e.urls?e.urls+",":"").concat(s),e},resultBuilder:function(e){return(0,E.camelizeKeys)(e[s])}})];case 2:return e=o.sent(),null==d||d(e),y(B(e)),[3,4];case 3:return o.sent(),t.current<=1?_():y(B()),[3,4];case 4:return[2]}})}));return(0,g.useEffect)(function(){(!L||k&&k.cached)&&p.current===s||_()},[L,k,_,s]),(0,g.useEffect)(function(){o&&m.current&&y(B(p.current!==s?{title:a}:null))},[o,B,a,s]),(0,g.useEffect)(function(){p.current=s},[s]),(0,g.useEffect)(function(){m.current=!0},[]),[x,k]},e5=function(e){A.Z.trackCardShow(e,{id:7844},{button:{text:"inlinezvideo"}})},te=function(e,t,o){var n;A.Z.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(n=t.onImageClick)||void 0===n||n.call(t,e,o)},tt=function(e,t,o){var n;A.Z.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(n=t.onImageClick)||void 0===n||n.call(t,e,o)},to=function(e,t,o){var n=e["data-text"],r=e.href,a=e.zvideoLinkCardProps;(0,g.useEffect)(function(){o&&(0,X.y3)(t.current,function(){return e5(t.current)})},[o,t]);var i=(0,b.A)(function(e){te(e,{title:n,url:r,video:{}})}),c=(0,b.A)(function(e){tt(e,a,{title:n,url:r})});return o?{handleImageClick:i,handleInfoClick:c}:{}},tn={answer:"Answer",article:"Column",zvideo:"Zvideo",question:"Question",collection:"Collection",roundtable:"Roundtable",topic:"Topic"},tr=g.forwardRef(function(e,t){var o=R()(e,["zvideoLinkCardProps"]),n=o.inEditor,r=o["data-text"],a=o.href,d=o.zaBlock,f=o.className,h=(0,s._)(o,["inEditor","data-text","href","zaBlock","className"]),p=(0,g.useRef)(),v=(0,u._)(e9(e),2),A=v[0],b=v[1],C=to(e,p,(null==b?void 0:b.objectType)==="zvideo"),y=C.handleImageClick,w=C.handleInfoClick,x=(0,g.useCallback)(en(t,A,p),[]),L=n?e0:k.$U,B=(0,m.tZ)(L,(0,l._)((0,c._)({},n?null:{as:e0,shouldTrackShow:!0,zaText:!0,zaType:"Button",zaAction:"OpenUrl",zaBlock:d,extra:{link:{url:a}},"data-za-module":"Content"}),{url:a,data:b,onClick:w,onClickImage:y,language:e.language}));return(0,m.tZ)(eB,(0,l._)((0,c._)({ref:x,text:r,url:a,component:"a",className:_()(f,(0,i._)({},"LinkCard--customStyle",!!(null==b?void 0:b.objectType)&&["column","podcast-channel","podcast-episode"].includes(b.objectType)))},h),{children:!!b&&(0,m.tZ)(k.eV,{content:{type:tn[b.objectType]||"Unknown"},children:B})}))}),ta=function(e){var t=e.idAttr,o=e.targetClassName;return function(e){var n=e.getAttribute(t),r=document.createElement("div");return r.className=o,e.parentNode.replaceChild(r,e),{data:{id:n},target:r}}},ti=function(e){return function(t){var o=(0,u._)((0,g.useState)(null),2),n=o[0],r=o[1],a=e.idAttr,i=e.selector,l=e.component,d=e.targetClassName,f=e.cardDataFilter,h=e.getCardProps,p=t.root,A=(0,s._)(t,["root"]),k=a&&i&&d&&(0,g.useCallback)(function(e){return ta({idAttr:a,targetClassName:d})(e)},[a,d]),b=(0,g.useMemo)(function(){return k?function(e){return Array.from(e.querySelectorAll(i)).map(k)}:v()},[k,p,i]);return(0,g.useEffect)(function(){if(p||i&&f){var e=(f||b)(p).map(function(e){var t=e.data,o=e.target,n=null;return"function"==typeof h&&(n=h(t)),(0,F.createPortal)((0,m.tZ)(l,(0,c._)({id:t.id},n,A),t.id),o)});e.length>0&&r(e)}},[p]),n}},tc=ti({cardDataFilter:function(e){return Array.from(e.querySelectorAll("a.LinkCard[data-draft-type=link-card]:not([data-is-ecommerce])")).map(function(e){var t=Array.from(e.attributes).reduce(function(e,t){return"class"===t.name?e.className=t.value:e[t.name]=t.value,e},{}),o=document.createElement("div");return o.className="RichText-LinkCardContainer",e.parentNode.replaceChild(o,e),{data:t,target:o}})},getCardProps:function(e){return e.href&&e.href.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)?e.zaBlock="ZTextZVideoLinkCard":e.zaBlock="ZTextLinkCard",e},component:tr}),tl=function(e){return{".LinkCard.old":{position:"relative",display:"block",margin:"1em auto",width:390,boxSizing:"border-box",borderRadius:12,maxWidth:"100%",overflow:"hidden","&,&:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"}},".LinkCard-ecommerceLoadingCard":{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:"inherit",height:80,boxSizing:"border-box",background:e.colorMod(e.colors.GBK10A).alpha(.88),color:e.colors.GBK08A},".LinkCard-ecommerceLoadingCardAvatarWrapper":{width:60,height:60,background:e.colors.GBK09A,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:6,marginRight:10},".LinkCard-ecommerceLoadingCardNetwork":{width:20,height:20},".LinkCard-ecommerceLoadingCardLoadingbar":{height:60,flex:1,display:"flex",flexDirection:"column",span:{height:16,display:"inline-block",background:e.colors.GBK09A},"span:nth-of-type(1)":{width:60,marginBottom:4},"span:nth-of-type(2)":{width:127}}}},ts=function(e){var t={fontSize:13,height:18,lineHeight:"18px",color:e.colors.MapText06A,wordBreak:"break-all"};return{position:"relative",display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",width:390,minHeight:84,borderRadius:8,maxWidth:"100%",overflow:"hidden",margin:"16px auto",padding:"12px 12px 9px 12px",backgroundColor:e.colors.GBK10A,"&, &:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"},"&.LinkCard--customStyle":{display:"block",padding:0,background:"linear-gradient(180deg, ".concat(e.colors.MapUIFrame99C," 0%, ").concat(e.colorMod(e.colors.MapUIFrame10A).alpha(.4)," 100%)"),"& .LinkCard-wrapper":{display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",minHeight:90,padding:12},"& .LinkCard-image":{width:66,height:66,borderRadius:"6px",marginRight:12,marginLeft:0}},".LinkCard-contents":{display:"block",flex:"1 1 auto",position:"relative",".loading":{height:14,background:e.colors.GBK09A,borderRadius:7},"&.withTitle":{marginBottom:3}},".LinkCard-title":(0,l._)((0,c._)({display:"block",fontSize:15,fontWeight:500,lineHeight:1.4,marginBottom:4,color:e.colors.GBK02A},(0,U.S)(1)),{"&.two-line":(0,c._)({lineHeight:"20px"},(0,U.S)(2)),"&.loading":{marginBottom:8,width:"80%","&.withTitle":{marginBottom:6}},"&.loadingTitle":{marginBottom:5}}),".LinkCard-excerpt":(0,l._)((0,c._)((0,l._)((0,c._)({display:"block",textOverflow:"ellipsis"},t),{marginBottom:4}),(0,U.S)(1)),{".LinkCard-author":{color:e.colors.GBK03A}}),".LinkCard-desc":(0,l._)((0,c._)({display:"block"},t,(0,U.S)(1)),{".LinkCard-tag,.tag":{display:"inline-block",fontSize:11,marginLeft:6,padding:"0 4px",borderRadius:3,lineHeight:"16px",background:e.colors.MapUIFrame09A},"&.loading":{width:"40%"},svg:{marginRight:2}}),".LinkCard-image":{flex:"0 0 auto",backgroundColor:e.colors.GBK09A,backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"block",width:60,height:60,marginLeft:20,objectFit:"cover",borderRadius:"inherit",overflow:"hidden","&.LinkCard-image--default":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.colors.GBK09A,color:e.colors.GBK08A,svg:{color:e.colors.GBK06A}},img:{width:"100%",height:"100%",objectFit:"cover"},".LinkCard-image--video":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",width:24,height:24,borderRadius:12,background:e.colorMod(e.colors.GBK99C).alpha(.9),pointerEvents:"none",svg:{color:e.colors.GBK03A}}},".LinkCard-richText":{".text":{color:e.colors.GBK03A},".bold":{fontWeight:e.fontWeights.bold},".tag":{marginLeft:4}},".PodcastEpisodeLinkCard-desc":{display:"flex",alignItems:"center"},".PodcastEpisodeLinkCard-duration":(0,l._)((0,c._)({},t),{flex:"0 0 auto",marginRight:"15px"}),".PodcastEpisodeLinkCard-collect":{height:18,width:20,flex:"0 0 20px",marginLeft:"auto",color:e.colors.MapText05A,position:"relative"},".PodcastEpisodeLinkCard-collect-icon":{position:"absolute",bottom:0,right:0},".PodcastEpisodeLinkCard-play":{height:34,width:34,flex:"0 0 34px",marginLeft:"auto",color:e.colors.MapBrand,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.colorMod(e.colors.MapBrand).alpha(.08),alignSelf:"flex-end"},".PodcastEpisodeLinkCard-play-icon":{marginLeft:"2px"},".PodcastEpisodeLinkCard .LinkCard-contents":{marginRight:"12px"}}},tu=function(e){return{".LinkCard.new":ts(e)}},td=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,(0,c._)({credentials:"include",headers:{"X-Requested-With":"Fetch"}},t)).then(function(e){return e.json()})},tf=function(e){return(0,c._)({},tl(e),tu(e))},th=function(e){return(0,c._)({},tu(e),tl(e))},tm=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.rootMargin,r=o.threshold,a=o.once,i=void 0===a||a;e=Array.isArray(e)?e:e?[e]:[];var c=(0,g.useRef)(null),l=(0,b.A)(t);(0,g.useEffect)(function(){if(e.length)return c.current&&e.forEach(function(e){return c.current.unobserve(e)}),c.current=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>0&&(l(e),i&&c.current.unobserve(e.target))})},{rootMargin:n,threshold:r}),e.forEach(function(e){return c.current.observe(e)}),function(){e.forEach(function(e){return c.current.unobserve(e)})}},[e,n,JSON.stringify(r),i])},tg=o(18837),tp="function"==typeof Image,tv={},tA=tp?tg(function(e){return new Promise(function(t){var o,n;return o=function(e,o){tv[e]=o,t(o)},void((n=new Image).onload=function(){var t=n.width>0&&n.height>0;o(e,t)},n.onerror=function(){o(e,!1)},n.src="data:image/webp;base64,"+({lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"})[e])})}):function(){return Promise.resolve(!1)},tk=function(e){var t=tv[e],o=(0,u._)((0,g.useState)(t),2),n=o[0],r=o[1];return tp&&void 0===t&&tA(e).then(r),n},tb={class:"className"},tC=(0,g.forwardRef)(function(e,t){var o=e.node,n=e.tagName,r=(0,s._)(e,["node","tagName"]),a=(0,g.useMemo)(function(){return Array.from(o.attributes).reduce(function(e,t){var o=tb[t.name]||t.name;return"style"!==o&&(e[o]=t.value),e},{})},[o]);return(0,g.createElement)(n||o.tagName.toLowerCase(),(0,l._)((0,c._)({},a,r),{ref:t}))}),ty=Y()(function(){return/Mobile/.test(navigator.userAgent)}),tw=function(e){var t=e.image,o=e.enableWebP,n=e.size,r=e.quality,a=t.dataset,i=a.actualsrc,c=a.actualgif;return o&&c&&c.match(/.gif$/i)?i:(n||(n="720w",!ty()&&window.devicePixelRatio>=1.5&&(n="1440w"),ty()&&window.devicePixelRatio*window.innerWidth>=1080&&(n="1440w")),(0,I.imgUrl)(i,{quality:void 0===r?80:r,size:n}))};function tx(e,t){A.Z.trackMonitor({name:t},{monitor:{type:"Event",imgResourceErrorInfo:{error_description:t,img_url:e,img_from:"web"}}})}var tL=function(e){var t=e.onLoadStateChange,o=e.onImageLoaded,n=e.enableWebP,r=e.size,a=e.quality;return function(e){var i=e.target,c=tw({image:i,enableWebP:n,size:r,quality:a});if(n&&(c=c.replace(/\.(jpg|png|jpeg|gif)/,".webp")),i.dataset.rawheight&&!i.getAttribute("height")&&i.setAttribute("height",i.dataset.rawheight),i.src=c,i.complete){i.dataset.lazyStatus="ok",null==o||o();return}t&&i.addEventListener("loadstart",function(){t("loadstart",c)}),i.dataset.lazyStatus="loading";var l=setTimeout(function(){i.complete||tx(i.url,"image_web_timeout_image"),t&&t("timeout",c)},15e3);i.addEventListener("load",function(){i.dataset.lazyStatus="ok",clearTimeout(l),tx(i.url,"image_web_success_image"),t&&t("load",c),null==o||o()}),i.addEventListener("error",function(){clearTimeout(l),tx(i.url,"image_web_fail_image"),t&&t("error",c)})}},tB=function(e){var t=e.node,o=e.useWebP,n=e.onLoadStateChange,r=e.size,a=e.quality,i=e.index,c=t.classList.contains("lazy"),l=tk("lossless"),s=(0,u._)((0,C.Y)({once:!0,rootMargin:"600px"}),3),d=s[0],f=s[1],h=s[2],p=(0,u._)((0,y.k)(!c),2),v=p[0],A=p[1],x=(0,b.A)(A.on),L=(0,b.A)(tL({onLoadStateChange:n,onImageLoaded:x,enableWebP:l&&(void 0===o||o),size:r,quality:a}));(0,g.useEffect)(function(){f&&L(h)},[h,f,L]);var B=(0,g.useMemo)(function(){return{elementLocation:{type:"Image",moduleId:"image_card",moduleIndex:i}}},[i]),z=(0,k.x3)(B),_=(0,w.q)(v?z:void 0,c?d:void 0),S=(0,k.Q4)().trackEvent,G=(0,b.A)(function(){return v&&S(B)});return(0,m.tZ)(tC,{node:t,ref:_,onClick:G})},tz=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.useWebP,n=t.disabled,r=void 0!==n&&n,a=t.onLoadStateChange,i=t.size,c=t.quality,l=(0,u._)((0,g.useState)([]),2),s=l[0],d=l[1];tm(s,tL({onLoadStateChange:a,enableWebP:tk("lossless")&&(void 0===o||o),size:i,quality:c}),{rootMargin:"300px"}),(0,g.useEffect)(function(){if(e&&!r){var t=Array.from(e.querySelectorAll("img.lazy:not([data-thumbnail])"));t.length&&d(t)}},[e,r])},t_=function(e){return tz(e.root,e.options),null},tS=function(e,t){A.Z.trackEvent(e,{action:"StatusReport",element:"Card"},{status:{result:t}})},tG=function(e,t){var o,n;null==window||null===(o=window.Raven)||void 0===o||null===(n=o.captureException)||void 0===n||n.call(o,e,{fingerprint:["gif2mp4"],extra:t})},tZ=function(e){var t=e.src,o=e.useWebP,n=void 0===o?"auto":o,r=e.useMp4,a=void 0!==r&&r,i=e.onRef,l=e.onLoadStateChange,d=e.onPlayChange,f=(0,s._)(e,["src","useWebP","useMp4","onRef","onLoadStateChange","onPlayChange"]),h=(0,u._)((0,g.useState)(""),2),p=h[0],k=h[1],b=(0,u._)((0,g.useState)(null),2),C=b[0],y=b[1],w=(0,u._)((0,g.useState)(Date.now()),2),L=w[0],B=w[1],z=(0,u._)((0,g.useState)(!1),2),_=z[0],S=z[1],G=(0,u._)((0,g.useState)(null),2),Z=G[0],R=G[1],I=tk("animation"),E=(0,g.useCallback)(function(){var e=((0,J.imgPathParse)(t)||{}).hash;a&&(0,X.y3)(C,function(){fetch("https://api.zhihu.com/gif2mp4/".concat(e),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then(function(e){return e.json()}).then(function(e){var t,o,n=e.playlist,r=(null==n?void 0:null===(t=n.SD)||void 0===t?void 0:t.play_url)||(null==n?void 0:null===(o=n.LD)||void 0===o?void 0:o.play_url);r&&$.ZP.increment("Gif2Mp4Player.mp4.fetch.success.count"),k(r)}).catch(v())})},[C,t,a]);(0,g.useEffect)(E,[t,a,C]),(0,g.useEffect)(function(){C&&A.Z.setModule(C,{module:"GifItem"})},[C]),tm(C,function(){A.Z.trackCardShow(C,{element:"Card"})}),(0,x.K)(function(){$.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),tG(Error("Gif2Mp4 play timeout"),{src:t,videoUrl:p}),S(!1)},_?2e3:null),(0,x.K)(function(){$.ZP.increment("Gif2Mp4Player.mp4.play.success.count"),$.ZP.timing("Gif2Mp4Player.mp4.first_frame_time",Date.now()-L-100),S(!1),R(null)},Z);var T=(0,J.default)(t,{extension:("auto"===n?I:n)?"webp":"gif"});return(0,m.tZ)(et.ZP,(0,c._)({videoUrl:p,src:T,onRef:(0,g.useCallback)(en(i,y),[]),onPlayChange:function(e){null==d||d(e),e||(B(Date.now()),p&&($.ZP.increment("Gif2Mp4Player.mp4.click.count"),S(!0)),A.Z.trackEvent(C,{action:"Click",element:"Image"}))},onLoadStart:function(){if(p){var e=ee.parse(p).expiration;e&&Number(e)<Date.now()/1e3+900&&E()}B(Date.now()),l&&l("loadstart",T)},onSuccess:function(){tS(C,"Success"),p?_&&R(100):$.ZP.timing("Gif2Mp4Player.gif.first_frame_time",Date.now()-L),l&&l("load",T)},onFailed:function(e){tS(C,"Fail"),p&&(_&&($.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),S(!1),R(null)),tG(e,{videoUrl:p,src:t})),l&&l("error",T)}},f))},tR=function(e){var t=e.dataset,o=t.thumbnail,n=t.size,r=t.rawheight;return{src:o,poster:o,size:n,width:t.rawwidth,height:r}},tI=function(e){var t=e.node,o=e.Component,n=void 0===o?tZ:o,r=(0,g.useMemo)(function(){return tR(t)},[t]);return(0,m.tZ)(n,(0,c._)({},r))},tE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.Component,n=void 0===o?tZ:o,r=(0,u._)((0,g.useState)(null),2),a=r[0],i=r[1];return(0,g.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));t.length&&i(t.map(function(e,t){var o=document.createElement("div");return o.className="RichText-gifPlaceholder",e.parentNode.replaceChild(o,e),(0,F.createPortal)((0,m.tZ)(tI,{node:e,Component:n},t),o)}))}},[e]),a},tT=function(e){return tE(e.root,e.options)},tN=function(e){var t=e.root,o=e.ConditionalImage,n=(0,u._)((0,g.useState)([]),2),r=n[0],a=n[1];return(0,g.useEffect)(function(){if(t){var e=Array.from(t.querySelectorAll("img.origin_image,img.content_image"));e.length&&a(e.map(function(e,t){var n=document.createElement("div");return e.parentNode.replaceChild(n,e),(0,F.createPortal)((0,m.tZ)(o,{index:t,node:e},t),n)}))}},[t]),r},tP=er([function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).linkCardInfo;return e?e.replace(eX,function(e,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=eV(o,{decodeValue:!0}),a=r.target,i=r.href,l=void 0===i?"":i,s=r["data-image"],u=r["data-image-width"],d=r["data-image-height"],f=r["data-entity-type"],h=r["data-entity-data"],g=r["data-size"];if(r["data-is-ecommerce"])return e;var p=n.replace(/<[^>]*>/g,"");p=eU(p),l.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)&&!p&&(p="知乎视频");var v=t?eM:eB;return(0,G.renderToStaticMarkup)((0,m.tZ)(v,(0,c._)({text:p,url:l,target:void 0===a?"_blank":a,image:s,imageWidth:u,imageHeight:d,entityType:f,entityData:eq(h),size:g},t&&{data:t[l]})))}):e},function(e){return e?e.replace(eQ,function(e,t){var o=eV(t,{decodeValue:!0}),n=o["data-draft-type"],r=o.href,a=o.class;return"link-card"!==n?e:(0,G.renderToStaticMarkup)((0,m.tZ)(eF,{url:r,className:K()(a,{old:!0,new:!1,static:!1})}))}):e}]),tW=(0,g.forwardRef)(function(e,t){var o=(0,u._)((0,g.useState)(null),2),n=o[0],r=o[1],a=e.html,i=e.css,l=e.options,d=void 0===l?{}:l,f=e.ConditionalImage,h=e.linkCardInfo,p=e.language,v=(0,s._)(e,["html","css","options","ConditionalImage","linkCardInfo","language"]),A=d.lazyLoadImageOptions,k=d.useGifPortalOption,b=(0,s._)(d,["lazyLoadImageOptions","useGifPortalOption"]);ec(n);var C=[tf,th,i].reduce(function(e,t){return(t||(t={}),"function"==typeof t)?function(o){return(0,c._)({},e(o),t(o))}:function(o){return(0,c._)({},e(o),t)}},function(e){return{}}),y=(0,g.useCallback)(en(t,r),[]);return(0,m.BX)(g.Fragment,{children:[!h&&(0,m.tZ)(tc,{css:th,root:n,language:p}),f?(0,m.tZ)(tN,{root:n,ConditionalImage:f}):(0,m.BX)(m.HY,{children:[(0,m.tZ)(t_,{root:n,options:A}),(0,m.tZ)(tT,{root:n,options:k})]}),(0,m.tZ)(ef,{root:n}),(0,m.tZ)(ex,(0,c._)({ref:y,html:tP(a,{linkCardInfo:h}),css:C,root:n,options:b},v))]})}),tD=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g}}]);
//# sourceMappingURL=lib-0e5ce61e.app.36c9b88b660626f096de.js.map